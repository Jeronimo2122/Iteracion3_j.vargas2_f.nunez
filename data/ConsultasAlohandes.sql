--REQUERIMIENTOS DE CONSULTA--

--RFC1--
SELECT RESERVA.ID_OPERADOR, OPERADOR.NOMBRE AS OPERADOR,SUM(PRECIO) AS DINERO_RECIBIDO
FROM RESERVA, OPERADOR
WHERE RESERVA.ID_OPERADOR = OPERADOR.ID 
GROUP BY RESERVA.ID_OPERADOR, OPERADOR.NOMBRE
;

--RFC2--
SELECT *
FROM (SELECT ALOJAMIENTO.ID, ALOJAMIENTO.TIPO_ALOJA, OPERADOR.NOMBRE AS OPERADOR,COUNT(*) AS CANT_RESERVAS
        FROM RESERVA, ALOJAMIENTO, OPERADOR
        WHERE RESERVA.ID_ALOJAMIENTO = ALOJAMIENTO.ID
            AND OPERADOR.ID = RESERVA.ID_OPERADOR
        GROUP BY ALOJAMIENTO.ID, ALOJAMIENTO.TIPO_ALOJA, OPERADOR.NOMBRE
        ORDER BY COUNT(*) DESC)
WHERE ROWNUM <= 20
;

--RFC3--
SELECT id, habitaciones_disponibles / num_habitaciones as indice_ocupacion
FROM hotel_hostal
UNION
SELECT id, numDisponible/numViviendas as indice_ocupacion
FROM edificio_universitario;

--RFC4--
SELECT ALOJAMIENTO.ID, ALOJAMIENTO.TIPO_ALOJA, OPERADOR.NOMBRE AS OPERADOR, COUNT(*) 
FROM RESERVA, ALOJAMIENTO_SERVICIO, ALOJAMIENTO, SERVICIO, OPERADOR
WHERE RESERVA.ID_ALOJAMIENTO = ALOJAMIENTO_SERVICIO.ID_ALOJA
    AND ALOJAMIENTO.ID = RESERVA.ID_ALOJAMIENTO
    AND ALOJAMIENTO_SERVICIO.ID_SERVICIO = SERVICIO.ID
    AND RESERVA.ID_OPERADOR = OPERADOR.ID
    AND reserva.fecha_llegada NOT BETWEEN TO_DATE('01/01/2020','DD/MM/YYYY') AND TO_DATE('11/11/2022','DD/MM/YYYY')
    AND reserva.fecha_salida NOT BETWEEN TO_DATE('01/01/2020','DD/MM/YYYY') AND TO_DATE('11/11/2022','DD/MM/YYYY')
    AND servicio.nombre in ('WI-FI','TINA')
    GROUP BY ALOJAMIENTO.ID, ALOJAMIENTO.TIPO_ALOJA, OPERADOR.NOMBRE
    HAVING COUNT(*) = 2
;

--RFC5--

--RFC6--

--RFC7--

--RFC8--

--RFC9--


